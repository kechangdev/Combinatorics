# The Pigeonhole Principle



### 鸽巢原理

- 如果要把 $n + 1$ 个物品放入 $n$ 个盒子，那么至少有一个盒子中存在不只一个物品。



##### 应用 1：

在 $13$ 个人中至少存在两人的出生日期在同一个月。



##### 应用 2：

设有 $n$ 对已婚夫妻。至少要从这 $2{n}$ 个人中选出多少人才能保证能够选出一对夫妻？

考虑 $n$ 个盒子，那么我们至少需要选择 $n + 1$ 个人才能保证至少一个盒子中存在不只一个人。



##### 应用 3：

给定 $m$ 个整数 $a_1, a_2, \dots, a_m$， 存在满足 $1 \leq k \leq l \leq m$ 的整数 $k, l$， 使得 $\sum_{i = k}^{l} a_i \% m = 0$。

证明如下：
考虑 $m$ 个和：
$$
\sum_{i = 1}^{1} a_i,\ \sum_{i = 1}^{2} a_i, \dots, \ \sum_{i = 1}^{m} a_i
$$
取出这 $m$ 个和的余数：
$$
\sum_{i = 1}^{1} a_i \% m,\ \sum_{i = 1}^{2} a_i \% m, \dots, \ \sum_{i = 1}^{m} a_i \% m
$$
那么现在会出现两种情况：
- 存在余数为 $0$ 
- 不存在余数为 $0$

对于第一种情况，我们可以确认存在  $\sum_{i = k}^{l} a_i \% m = 0$。

对于第二种情况：
$$
0 < \sum_{i = k}^{l} a_i \% m < m
$$
一共存在 $m - 1$ 种可能的余数，但是有 $m$ 个余数。由鸽巢原理，那么一定至少有一对余数是相同的，假设是第 $k, l$ 个，且 $k < l$ ， 那么有：
$$
\sum_{i = k}^{l} a_i \% m - \sum_{i = 1}^{k} a_i \% m = 0
$$
即存在满足 $1 \leq k \leq l \leq m$ 的整数 $k, l$， 使得 $\sum_{i = k}^{l} a_i \% m = 0$。



##### 应用 4:

一位国际象棋大师有 $11$ 周的时间备战一场锦标赛，他决定每天至少下一盘棋，但为了不使自己过于疲劳他还决定每周不能下超过 $12$ 盘棋。证明存在连续若干天，期间这位大师恰好下了 $21$ 盘棋。

证明如下：

一共有 $n = 11 * 7 = 77$ 天，假设每天下 $a_1, a_2, ···, a_{77}$ 盘棋，那么有 **前缀和** 数组 $sum_1, sum_2, ···, sum_{77}$ 且存在如下性质：
$$
1 \leq sum_1 < sum_2 < sum_3 < ··· < sum_{77} \leq 12 * 11 = 132
$$
我们可以得到：
$$
22 \leq sum_1 + 21 < sum_2 + 21 < sum_3 + 21 < ··· < sum_{77} + 21 \leq 153
$$
那么对于我们的 $77 * 2 = 154$ 个 $sum$，有：
$$
1 \leq sum_1 , sum_2 , sum_3 , ··· < sum_{77} , sum_1 + 21, sum_2 + 21, sum_3 + 21 + ··· + sum_{77} + 21 \leq 153
$$
$$
\forall (i,j) \in \{1,2,3,\ldots,77\} \,with \, i \neq j: sum_i \neq sum_j
$$

$$
\forall (i,j) \in \{1,2,3,\ldots,77\} \,with \, i \neq j: sum_i + 21 \neq sum_j + 21
$$

由鸽巢原理，我们可以知道一定存在 $i, j$ ，使得 $sum_i = sum_j + 21$ 。

所以，存在连续若干天，期间这位大师恰好下了 $21$ 盘棋。

证毕！



##### 应用 5:

从整数 $1, 2, ···, 200$ 中选出 $101$ 个整数。证明在所选的这些整数之间存在两个这样的整数，其中一个可被另一个整除。

证明如下：
对于每个数，我们可以将其转换为 $2^i · a$ ，其中 $a$ 为奇数。

在 $1, 2, ···, 200$ 中，一共有 $100$ 个奇数。

由鸽巢原理，一定存在两个数的奇数是相同的，假设这两个数为 $2^i · a, 2^j · a$。

一定存在 $2^i \% 2^j = 0$ 或 $2^j \% 2^i = 0$ 。

所以，所选的这些整数之间一定存在两个这样的整数，其中一个可被另一个整除。

证毕！



##### 中国剩余定理

前置知识 **同余**， **逆元**， **欧几里得算法**，**贝祖定理**， **拓展欧几里得算法**。

>###### 欧几里得算法
>
>对于任何两个整数 $a$ 和 $b$ ，他们的最大公约数 $gcd(a, b)$ 可以通过递归方式使用欧几里得算法来计算，该算法基于如下性质：
>
>对任意两个正整数 $a$ 和 $b$（$a > b$），他们的最大公约数 $gcd(a, b)$ 等于 $b$ 和 $a$ 除以 $b$ 的余数（即 $a % b$）的最大公约数，即 
>$$
>gcd(a, b) = gcd(b, a \% b)
>$$
>
>该等式实际是 **更相减损术** 的优化，利用了 $GCD$ 的性质：
>$$
>gcd(a, b) = gcd(max(a - b, b), min(a - b, b))
>$$
>
>###### 拓展欧几里得算法
>
>对于 **贝祖等式**：
>$$
>a{x} + b{y} = n
>$$
>方程有解的条件当且仅当： $n$ 是 $gcd(a, b)$ 的倍数。
>
>证明如下：
>在欧几里得算法的最后一步，出现 $b = 0$, 显然有一对整数 $x = 1, y = 0$ ，使得 $a · 1 + 0 · 0 = gcd(b, a \% b)$ 。
>
>当 $b > 0$ 时，由 $gcd(a, b) = gcd(b, a \% b)$ ，假设存在一对 $x, y$ ，满足 $b · x + (a \% b) · y = gcd(b, a \% b)$ 。
>
>那么：
>$$
>b \cdot x + (a \% b) \cdot y = b \cdot x + (a - b \cdot \lfloor{a / b}\rfloor) \cdot y = a \cdot y + b \cdot (x - \lfloor{a / b}\rfloor \cdot y)
>$$
>我们令 $x` = y, y` = x - \lfloor{a / b}\rfloor \cdot y$ ， 可以得到 $ax` + by` = gcd(a, b)$ 。
>
>递归即可。
>
>证毕！

设 $m$ 和 $n$ 是互素的正整数，并设 $a$ 和 $b$ 为整数，其中 $0 \leq a \leq m - 1$, $0 \leq b \leq n - 1$ 。于是，存在正整数 $x$ ，使得：

- $x$ 除以 $m$ 的余数为 $a$ 
- $x$ 除以 $n$ 的余数为 $b$ 

证明如下：
考虑有 $n$ 个整数 $a, m + a, 2m + a, 3m + a, ···, (n - 1)m + a$ ， 易知这些整数除以 $m$ 的余数为 $a$ 。

我们可以知道这些数除以 $n$ 的余数都不同。证明如下：
>假设有两个整数除以 $n$ 的余数相同，这两个数为 $im + a, jm + a$ ，其中 $0 \leq i < j \leq n - 1$ 。
>
>存在：
>
>- $im + a = q_in + r$
>- $jm + a = q_jn + r$
>
>两式做差，得到：
>$$
>(j - i)m = (q_j - q_i)n
>$$
>由于 $m$ 与 $n$ 互质，所以 $(j - i)$ 是 $n$ 的因子，但是 $0 \leq i < j \leq n - 1$ ，所以 $(j - i)$ 不可能是 $n$ 的因子，这就产生了矛盾。

由鸽巢原理，我们知道所有的 $0, 1, 2, ···, n - 1$ 是这 $n$ 个整数对 $n$ 取模的值。

由于 $0 \leq b \leq n - 1$ ，在这 $n$ 个整数对 $n$ 取模的值域。设 $p$ 为整数， $0 \leq p \leq n - 1$ ，使得 $x = pm + a$ 除以 $n$ 的余数为 $b$ ，那么存在某个数 $q$ ，有
$$
x = qn + b
$$
得证  $x = pm + a$ 且 $x = qn + b$ 

证毕！

既然都已经证明了 $x$ 存在了，那么我们再考虑 $x$ 的值如何计算。



先给出结论：

设 $m_1, m_2, ···, m_n$ 是两两互质的整数， $m = \prod_{i = 1}^{n} {m_i}, M_i = m / m_i$， $t_i$ 是线性同余方程 ${M_i}{t_i} \equiv 1 \pmod{m_i}$ 的一个解。

那么对于任意 $n$ 个整数 $a_1, a_2, ···, a_n$ ，方程组
$$
\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
... \\
x \equiv a_n \pmod{m_n} \\
\end{cases}
$$
有整数解：
$$
x = \sum_{i = 1}^{n} {a_i}{M_i}{t_i}
$$

> **证明过程在之后补充。**



##### 应用 7:

设 $q_1, q_2, ···, q_n$ 是正整数。如果将
$$
\sum_{i = 1}^{n} q_i - n + 1
$$
个物品放入 $n$ 个盒子内，那么或者第一个盒子至少含有 $q_1$ 个物品，或者第二个盒子至少含有 $q_2$ 个物品，···，或者第 $n$ 个盒子中至少含有 $q_n$ 个物品。

证明如下：
假设所有盒子中的物品数目都小于 $q_i$ ，假设都为 $q_i - 1$ ， 那么所有盒子中物品总数为：
$$
(q_1 - 1) + (q_2 - 1) + ··· + (q_n - 1) = \sum_{i = 1}^{n} q_i - n
$$
这与之前我们的目的将 $\sum_{i = 1}^{n} q_i - n + 1$ 个物品放入盒子矛盾。

所以或者第一个盒子至少含有 $q_1$ 个物品，或者第二个盒子至少含有 $q_2$ 个物品，···，或者第 $n$ 个盒子中至少含有 $q_n$ 个物品。

证毕！



##### 应用 8:

设 $n$ 和 $r$ 都是正整数。如果把 $n(r - 1) + 1$ 个物品分配到 $n$ 个盒子中，那么至少有一个盒子含有 $r$ 个或更多的物品。

 
